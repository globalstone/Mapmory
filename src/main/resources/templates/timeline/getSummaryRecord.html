<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
	<meta charset="UTF-8">
	<title>Insert title here</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/5/cosmo/bootstrap.css">
<link rel="stylesheet" href="/css/common/footer.css">
<link rel="stylesheet" href="https://code.jquery.com/ui/1.13.3/themes/base/jquery-ui.css">
<style type="text/css">
#datepicker{
	width: 150px;
}
</style>
</head>
<body>
<div id=content-for-footer>
	<div th:if="!(${recordList}==null)">
		<h1 th:text="${'getSummaryRecord'}"></h1>
		<!-- <a th:href="@{/timeline/getSummaryRecord(searchCondition=0)}" th:text="${'getSummaryRecordSelectDate'}"></a><br/>
		<a th:href="@{/timeline/getSummaryRecord(userId=${record.recordUserId})}" th:text="${'getSummaryRecordLeftDate'}"></a><br/>
		<a th:href="@{/timeline/getSummaryRecord(userId=${record.recordUserId})}" th:text="${'getSummaryRecordRightDate'}"></a><br/> -->
		<input type="hidden" th:name="selectDate">
		
		<h4>
			<svg th:name="getSummaryRecordLeft" xmlns="http://www.w3.org/2000/svg" height="40px" viewBox="0 -960 960 960" width="40px" fill="#1F85DE"><path d="M400-80 0-480l400-400 61 61.67L122.67-480 461-141.67 400-80Z"/></svg>
			<input class="text-center" id="datepicker" type="text" th:name="getSummaryRecordSelect" th:value="${selectDate}" readonly="readonly" />
			<input type="hidden" th:name="selectDate" th:value="${selectDate}" />
			<svg th:name="getSummaryRecordRight" xmlns="http://www.w3.org/2000/svg" height="40px" viewBox="0 -960 960 960" width="40px" fill="#1F85DE"><path d="m309.67-81.33-61-61.67L587-481.33 248.67-819.67l61-61.66 400 400-400 400Z"/></svg>
		</h4>
		<div class="container text-center">
			<div class="row">
			    <div class="col-12 col-md-6 col-lg-4" th:each="record : ${recordList}">
		            <!-- 미디어 파일이 있으면 렌더링 -->
		            <div class="media-preview">
		                <video th:if="${record.mediaName}" controls muted preload="metadata" class="preview-video">
		                    <!-- 자동 재생이 필요하면 autoplay 속성 추가 -->
		                    <source th:src="'data:video/mp4;base64,' + ${record.mediaByte}" type="video/mp4">
		                </video>
		                <!-- 동영상을 클릭할 때 동작하는 스크립트
		                <script th:inline="javascript">
		                    /*<![CDATA[*/
		                    function playVideo(mediaName) {
		                        // 동영상을 재생
		                        var video = document.querySelector('.preview-video');
		                        if (video) {
		                            video.src = "@{/path/to/media/}" + mediaName;
		                            video.load();
		                            video.play();
		                            video.controls = true; // 재생 중에는 컨트롤 보이기
		                        }
		                    }
		                    /*]]>*/
		                </script>
		                동영상 클릭 시
		                <span th:if="${record.mediaName}" onclick="playVideo('${record.mediaName}')">
		                    Click to play video
		                </span> -->
		            </div>
				    <!-- 이미지가 있으면 렌더링 -->
				    <span th:if="${record.imageName}">
				        <img th:src="'data:image/png;base64,' + ${record.imageByte}"  alt="Image" style="width:100%;" >
				    </span>
			    </div>
			</div>
		</div>
		
	</div>
	<div th:if="${recordList}==null">
		<p th:text="'기록 없습니다.'"></p>
	</div>
</div>
<div th:replace="common/footer::defaultFooter"></div>

<script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/ui/1.13.3/jquery-ui.js" integrity="sha256-J8ay84czFazJ9wcTuSDLpPmwpMXOm573OUtZHPQqpEU=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script th:inline="javascript">
$(function() {
	let selectDate=$('input[name="getSummaryRecordSelect"]').val();
	let uri;
	
	$( "#datepicker" ).datepicker({
		dateFormat :"yy-mm-dd",
		onSelect: function(dateText) {
	        console.log("사용자가 선택한 날짜:", dateText);
	        // 여기서 선택한 날짜를 원하는 방식으로 처리할 수 있음
	        // 예: AJAX 요청을 보내거나 다른 동작을 수행
			uri="?searchCondition="+0+"&selectDate="+dateText
			self.location.replace("/timeline/getSummaryRecord"+uri);
	    }
	});
	
	$("svg[name='getSummaryRecordLeft']").click(function() {
		uri="?searchCondition="+1+"&selectDate="+selectDate
		self.location.replace("/timeline/getSummaryRecord"+uri);
	})
	
	$("svg[name='getSummaryRecordRight']").click(function() {
		uri="?searchCondition="+2+"&selectDate="+selectDate
		self.location.replace("/timeline/getSummaryRecord"+uri);
	})
})
</script>
</body>
</html>